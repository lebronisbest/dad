<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>건설재해예방전문지도기관 기술지도 결과보고서</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Malgun Gothic', sans-serif;
        }
        
        /* 빈 섹션 자동 숨김 */
        .section:empty {
            display: none;
        }
        
        /* 페이지 구분을 위한 스타일 */
        .page-break {
            page-break-after: always;
            border-top: 2px dashed #cbd5e0;
            margin-top: 2rem;
            padding-top: 2rem;
        }
        
        /* 인쇄 최적화 */
        @media print {
            body {
                -webkit-print-color-adjust: exact;
                margin: 0;
                padding: 0;
            }
            .page-break {
                page-break-after: always;
                border-top: none;
                margin: 0;
                padding: 0;
                height: 0;
                overflow: hidden;
            }
            .avoid-break {
                page-break-inside: avoid;
            }
            /* PDF 렌더링 최적화 */
            * {
                box-sizing: border-box;
            }
            section {
                page-break-inside: avoid;
            }
        }
        
        /* 테이블 테두리 스타일 */
        table, th, td {
            border: 1px solid #4a5568;
        }
        th, td {
            padding: 0.5rem 0.75rem;
            vertical-align: middle;
            text-align: center;
        }
        
        /* 표/리스크매트릭스 인쇄 안정화 */
        table { 
            width: 100%; 
            border-collapse: collapse; 
        }
        thead { 
            display: table-header-group; /* 페이지 넘어가도 헤더 반복 */
        }
        tfoot { 
            display: table-footer-group; 
        }
        th, td { 
            padding: 6pt 8pt; 
            border: 1px solid #ddd; 
        }
        tbody tr { 
            page-break-inside: avoid; 
        }
        
        /* 헤더 셀 스타일 */
        th {
            background-color: #f0f4f8; /* 약간 더 진한 회색 */
            font-weight: 600;
        }
        /* 기본 셀 스타일 */
        td {
            background-color: #ffffff;
        }
        /* 결재 테이블 특별 스타일 */
        .approval-table {
            border: 2px solid #1f2937 !important;
        }
        .approval-table th,
        .approval-table td {
            border: 1px solid #1f2937 !important;
        }
        .approval-table .vertical-text {
            writing-mode: vertical-rl;
            text-orientation: mixed;
        }
        
                /* 사진 그리드 스타일 - 이미지와 완전히 일치 */
        .photo-grid-container {
            width: 100%;
            padding: 1rem 0;
        }
        
        .photo-row {
            display: flex;
            justify-content: space-between;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .photo-item {
            flex: 1;
            max-width: calc(50% - 0.75rem);
        }
        
        .photo-placeholder {
            background: #ffffff;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            padding: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .photo-image {
            width: 100%;
            aspect-ratio: 1 / 1;
            background: #f3f4f6;
            border: 1px solid #e5e7eb;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 0.5rem;
            position: relative;
        }
        
        .photo-image::before {
            content: "📷";
            font-size: 1.5rem;
            opacity: 0.4;
        }
        
        .photo-number {
            position: absolute;
            top: 0.25rem;
            left: 0.25rem;
            font-size: 0.75rem;
            font-weight: 500;
            color: #6b7280;
            background: rgba(255, 255, 255, 0.8);
            padding: 0.125rem 0.375rem;
            border-radius: 2px;
        }
        
        .photo-caption {
            text-align: center;
        }
        
        .caption-main {
            font-size: 0.75rem;
            font-weight: 600;
            color: #374151;
            margin: 0 0 0.25rem 0;
            line-height: 1.2;
        }
        
        .caption-sub {
            font-size: 0.625rem;
            color: #6b7280;
            margin: 0;
            line-height: 1.2;
        }
        
        /* 인쇄 시 사진 그리드 최적화 */
        @media print {
            .photo-row {
                page-break-inside: avoid;
                margin-bottom: 1.5rem;
            }
            
            .photo-item {
                page-break-inside: avoid;
            }
            
            .photo-placeholder {
                border: 1px solid #4a5568;
                background: #ffffff;
                box-shadow: none;
            }
            
            .photo-image {
                background: #f8f9fa;
                border: 1px solid #dee2e6;
            }
        }
        
        /* 결재 서명 스타일 */
        .signature-section {
            font-size: 1.1rem;
            font-weight: 700;
            letter-spacing: 0.1em;
        }
        .signature-circle {
            width: 2.5rem;
            height: 2.5rem;
            border: 2px solid #1f2937;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .signature-line {
            width: 1.25rem;
            height: 0.125rem;
            background-color: #1f2937;
            border-radius: 0.0625rem;
        }
        /* 체크박스 스타일 */
        .custom-checkbox {
            width: 1rem;
            height: 1rem;
            border: 1px solid #4a5568;
            display: inline-block;
            margin-right: 0.25rem;
            vertical-align: middle;
        }
        .highlight-red {
            background-color: #fef2f2;
            color: #ef4444;
        }
        
        /* 사진 대지 표준(3×N 그리드 + 캡션/참조) */
        .photo-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10pt;
        }
        .photo-item {
            border: 1px solid #ddd;
            padding: 8pt;
            border-radius: 4pt;
        }
        .photo-item img {
            width: 100%;
            height: auto;
            border-radius: 2pt;
        }
        figcaption {
            font-size: 9pt;
            color: #555;
            margin-top: 4pt;
            text-align: center;
        }
        
        /* 법령 인용 박스 */
        .citation-box {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6pt;
            padding: 12pt;
            margin: 16pt 0;
        }
        .citation-item {
            margin-bottom: 8pt;
            padding-bottom: 8pt;
            border-bottom: 1px solid #e9ecef;
        }
        .citation-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        /* 폰트/여백 고정(인쇄 깡패 세팅) */
        body {
            font-size: 10.5pt;
            line-height: 1.5;
        }
        h1, h2, h3 {
            font-size: 11pt;
            line-height: 1.4;
        }
        table {
            font-size: 9pt;
            line-height: 1.4;
        }
        .photo-grid figcaption {
            font-size: 8pt;
            line-height: 1.3;
        }
        
        /* 인용 필요 경고 배지 */
        .citation-warning {
            display: inline-block;
            background-color: #fff3cd;
            color: #856404;
            padding: 4pt 8pt;
            border-radius: 4pt;
            font-size: 8pt;
            border: 1px solid #ffeaa7;
        }
    </style>
</head>
<body class="bg-white p-4 sm:p-8">

        <!-- ==================== 페이지 1 ==================== -->
        <section id="page1" class="section">
                    <!-- 헤더: 로고, 회사명, 슬로건, 결재란 -->
        <header class="flex justify-between items-start mb-6">
            <div class="flex-1">
                <div class="mb-4">
                    <img data-image="org.logo_data_uri" alt="로고" class="h-32 w-auto mx-auto mb-4">
                    <p class="text-blue-700 font-semibold text-center">"어떠한 보상도 재해로 나빠진 삶의 질을 대신 할 수 없어요..!"</p>
                </div>
            </div>
            <div class="w-64 ml-auto">
                <table class="w-full border-collapse text-sm approval-table">
                    <tr>
                        <th rowspan="3" class="w-1/6 bg-gray-100 font-bold text-gray-800 text-center align-middle vertical-text">
                            결재
                        </th>
                        <th class="w-1/4 bg-gray-100 font-bold text-gray-800 text-center py-2">담당</th>
                        <th class="w-1/4 bg-gray-100 font-bold text-gray-800 text-center py-2">부서장</th>
                        <th class="w-1/4 bg-gray-100 font-bold text-gray-800 text-center py-2">대표</th>
                    </tr>
                    <tr>
                        <td class="h-20 bg-white"></td>
                        <td class="h-20 bg-white"></td>
                        <td class="h-20 bg-white"></td>
                    </tr>
                    <tr>
                        <td class="h-5 bg-white text-center text-gray-600 text-lg">/</td>
                        <td class="h-5 bg-white text-center text-gray-600 text-lg">/</td>
                        <td class="h-5 bg-white text-center text-gray-600 text-lg">/</td>
                    </tr>
                </table>
            </div>
        </header>

            <!-- 문서 제목 -->
            <h2 class="text-2xl font-bold text-center my-6 pt-2 pb-2 border-b-4 border-t-4 border-gray-700">
                건설재해예방전문지도기관 기술지도 결과보고서
            </h2>

            <!-- 1. 기술지도 대상사업장 -->
            <section class="mb-8 section">
                <h3 class="text-lg font-bold mb-3 text-left">1. 기술지도 대상사업장</h3>
                <table class="w-full border-collapse text-sm">
                    <tbody>
                        <tr>
                            <th rowspan="4" class="w-16">현장</th>
                            <th class="w-32">현장명</th>
                            <td colspan="3" class="text-left" ?????data-field="site.name"></td>
                            <th class="w-32">사업장관리번호<br>(사업개시번호)</th>
                            <td class="w-40" data-field="site.management_number"></td>
                        </tr>
                        <tr>
                            <th>공사기간</th>
                            <td colspan="3" class="text-left" data-field="site.construction_period"></td>
                            <th class="w-24">공사금액</th>
                            <td class="text-left" data-field="site.construction_amount"></td>
                        </tr>
                        <tr>
                            <th>책임자</th>
                            <td colspan="3" class="text-left" data-field="site.responsible_person"></td>
                            <th>연락처<br>(이메일)</th>
                            <td colspan="1" class="text-left">
                                <span data-field="site.phone"></span><br>
                                <span data-field="site.email"></span>
                            </td>							
                        </tr>
                        <tr>
                            <th>주소</th>
                            <td colspan="5" class="text-left" ??? ???data-field="site.address"></td>
                        </tr>
                        <tr>
                            <th rowspan="3" class="w-16">본사</th>
                            <th>회사명</th>
                            <td colspan="3" class="text-left" ?????data-field="org.name"></td>
                            <th>법인등록번호<br>(사업자등록번호)</th>
                            <td data-field="org.registration_number"></td>
                        </tr>
                        <tr>
                            <th>면허번호</th>
                            <td colspan="3" class="text-left" data-field="org.license_number"></td>
                            <th>연락처</th>
                            <td colspan="3" data-field="org.phone"></td>
                        </tr>
                        <tr>
                            <th>주소</th>
                            <td colspan="5" class="text-left" data-field="org.address"></td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- 2. 기술지도 개요 -->
            <section class="section">
                <h3 class="text-lg font-bold mb-3 text-left">2. 기술지도 개요</h3>
                <table class="w-full border-collapse text-sm">
                    <tbody>
                        <tr>
                            <th class="w-32">지도기관명</th>
                            <td class="text-left" data-field="guide.org_name">&nbsp;</td>
                            <th class="w-32">기술지도실시일</th>
                            <td class="w-40" 2024-12-19data-field="visit.date" data-format="formatDate"></td>
                        </tr>
                        <tr>
                            <th>구분</th>
                            <td class="text-left">
                                <span class="custom-checkbox" data-checkbox="category.is_construction"></span><span>건설</span> /
                                <span class="custom-checkbox" data-checkbox="category.is_electrical"></span>전기·정보통신
                            </td>
                            <th>공정률</th>
                            <td>( <span data-field="progress.percent"></span> ) %</td>
                        </tr>
                        <tr>
                            <th>횟수</th>
                            <td>( <span data-field="visit.round" data-format="roundText"></span> ) 회차 / 총 ( <span data-field="visit.round_total"></span> ) 회</td>
                            <th>담당 요원</th>
                            <td data-field="guide.inspector"></td>
                        </tr>
                        <tr>
                            <th>이전 기술지도<br>이행여부</th>
                            <td class="text-left">
                                <span class="custom-checkbox" data-checkbox="guide.previous_completed"></span>이행 / 
                                <span class="custom-checkbox" data-checkbox="guide.previous_incomplete"></span>불이행
                            </td>
                            <th>연락처</th>
                            <td data-field="guide.phone"></td>
                        </tr>
                        <tr>
                            <th>현장책임자 등<br>통보방법</th>
                            <td colspan="3" class="text-left">
                                <div class="flex items-center flex-wrap space-x-4">
                                    <span>직접전달 ( 성명: <span class="inline-block w-20 border-b border-gray-500" data-field="site.responsible_person"></span> 서명: ( &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ) )</span>
                                    <span>
                                        <span class="custom-checkbox" data-checkbox="notification.registered_mail"></span>등기우편 /
                                        <span class="custom-checkbox" data-checkbox="notification.email"></span>전자우편</span> /
                                        <span class="custom-checkbox" data-checkbox="notification.mobile"></span>모바일 /
                                        <span class="custom-checkbox" data-checkbox="notification.other"></span>기타 ( <span data-field="notification.other_method"></span> )
                                    </span>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <th>작업 상황 및<br>특이사항</th>
                            <td colspan="3" class="h-24 align-top text-left">
                                <p><span class="custom-checkbox" data-checkbox="work.is_working_today"></span>금일작업중인 사항 : <span data-field="work.today_work"></span></p>
                                <p>- 현재 작업내용 : <span data-field="work.current_work"></span></p>
                                <p data-field="work.additional_notes"></p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>
        </section>

      <div class="page-break"></div>

        <!-- ==================== 페이지 2 ==================== -->
        <section id="page2" class="section">
            <!-- 3. 이전 기술지도 사항 이행여부 -->
            <section class="mb-8 section">
                <h3 class="text-lg font-bold mb-3 text-left">3. 이전 기술지도 사항 이행여부</h3>
                <table class="w-full border-collapse text-sm">
                    <thead>
                        <tr>
                            <th>지도일<br>(확인일)</th>
                            <th>유해·위험장소</th>
                            <th>유해·위험요인</th>
                            <th>지적사항</th>
                            <th>이행<br>결과</th>
                        </tr>
                    </thead>
                    <tbody data-repeat="previous_guidance"></tbody>
                </table>
            </section>

            <!-- 4. 현재 공정 내 현존하는 위험성 평가 -->
            <section class="section">
                <h3 class="text-lg font-bold mb-3 text-left">4. 현재 공정 내 현존하는&nbsp; 위험성 제거&nbsp; &nbsp;</h3>
                <h3 class="text-lg font-bold mb-3 text-left">위험성 평가(3레벨-3x3단계)</h3>
                <table class="w-full border-collapse text-sm">
                    <thead>
                        <tr>
                            <th>구분</th>
                            <th colspan="2">가능성(빈도)</th>
                            <th>구분</th>
                            <th colspan="2">중대성(강도)</th>
                            <th colspan="2">구분</th>
                            <th colspan="1">개선방법</th>
                        </tr>
                        <tr>
                            <td>상</td>
                            <td>높음</td>
                            <td>3</td>
                            <td>대</td>
                            <td>사망(장애 발생)</td>
                            <td>3</td>
                            <td>6~9</td>
                            <td>높음</td>
                            <td>즉시 개선</td>
                        </tr>
                        <tr>
                            <td>중</td>
                            <td>보통</td>
                            <td>2</td>
                            <td>중</td>
                            <td>업무 복귀 및 완치 가능</td>
                            <td>2</td>
                            <td>3~4</td>
                            <td>보통</td>
                            <td>개선</td>
                        </tr>
                        <tr>
                            <td>하</td>
                            <td>낮음</td>
                            <td>1</td>
                            <td>소</td>
                            <td>아차 사고 초래 위험</td>
                            <td>1</td>
                            <td>1~2</td>
                            <td>낮음</td>
                            <td>필요에 따라 개선</td>
                        </tr>
                    </thead>
                </table>
                <br>
                <table class="w-full border-collapse text-sm mt-[-1px]">
                    <thead>
                        <tr>
                            <th>유해·위험장소</th>
                            <th>유해·위험요인</th>
                            <th>개선방법</th>
                            <th>가능성<br>(빈도)</th>
                            <th>중대성<br>(강도)</th>
                            <th>위험성<br>수준</th>
                            <th>개선<br>우선순위</th>
                        </tr>
                    </thead>
                    <tbody data-repeat="hazards"></tbody>
                </table>
            </section>
        </section>

        <div class="page-break"></div>
        
        <!-- ==================== 페이지 3 ==================== -->
        <section id="page3" class="section">
            <!-- 5. 향후 진행공정에 대한 유해·위험 요인 파악 및 대책 -->
            <section class="mb-8 section">
                <h3 class="text-lg font-bold mb-3 text-left">5. 향후 진행공정에 대한 유해·위험 요인 파악 및 대책</h3>
                <table class="w-full border-collapse text-sm">
                    <thead>
                        <tr>
                            <th colspan="2">다음방문 시 까지 발생하<br>는 주요 진행 공정</th>
                            <th>유해·위험<br>요인</th>
                            <th>유해·위험요인을 제거하기 위한 예방대책</th>
                            <th>비고</th>
                        </tr>
                    </thead>
                    <tbody data-repeat="future_work"></tbody>
                </table>
            </section>

            <!-- 6. 사업장 지원 사항 등 기타 사항 -->
            <section class="section">
                <h3 class="text-lg font-bold mb-3 text-left">6. 사업장 지원 사항 등 기타 사항</h3>
                <table class="w-full border-collapse text-sm">
                    <thead>
                        <tr>
                            <th>자료<br>제공</th>
                            <th>구체적 사항</th>
                            <th>비고</th>
                        </tr>
                    </thead>
                    <tbody data-repeat="support"></tbody>
                </table>
            </section>
        </section>
        
        <div class="page-break"></div>

        <!-- ==================== 페이지 4 ==================== -->
        <section id="page4" class="section">
            <h2 class="text-2xl font-bold text-center my-6">사 진 대 지</h2>
            
            <!-- 사진 그리드 컨테이너 -->
            <div class="photo-grid-container avoid-break" data-repeat="photos">
                <div class="photo-item">
                    <figure class="text-center">
                        <img class="photo-image" data-image="url" alt="">
                        <figcaption class="photo-caption">
                            <div class="caption-main" data-field="caption_main"></div>
                            <div class="caption-sub" data-field="caption_sub"></div>
                        </figcaption>
                    </figure>
                </div>
            </div>
        </section>
    </div>
</body>
</html>
